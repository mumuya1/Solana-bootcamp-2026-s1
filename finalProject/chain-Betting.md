# 项目名称

Solana 链上竞猜 DApp（Chain Betting）

---

## 💻 项目 Repo

https://github.com/mumuya1/chain-Betting

---

## 📌 项目简介

本项目是一个基于 Solana 的链上竞猜 DApp。用户可以在链上创建比赛竞猜池，设定单张票价、总票数上限和截止时间，并通过 Phantom 钱包参与三方竞猜（主胜 / 平局 / 客胜）。

合约在链上维护每个竞猜池的状态（未初始化、进行中、已取消、已结算），并记录三方的总票数。前端会根据总票数和初始赔率动态计算展示赔率，结算时支持管理员手动指定结果，或者由合约基于伪随机数自动选择获胜方。项目希望通过链上透明结算和不可篡改的记录，为小型赛事和个人发起的竞猜提供一个简单可信的解决方案。

---

## 🛠️ 技术栈

- **区块链 / 合约**
  - Solana
  - Rust 编写 on-chain program（不依赖 Anchor）
  - 使用固定 96 字节账户布局存储竞猜池状态（票价、总票数上限、截止时间、三方总票数、结算结果等）

- **前端**
  - React + TypeScript
  - Vite 作为构建工具
  - @solana/web3.js 与合约交互（创建池、下注、拉取所有池子）
  - Phantom 钱包集成：连接 / 断开 / 查询余额

- **工具与开发体验**
  - Solana CLI（本地测试链部署与调试）
  - ESLint + TypeScript 保证前端代码质量
  - Buffer polyfill + Vite 配置，解决浏览器环境中 `buffer` 模块兼容问题
  - localStorage 持久化 UI 配置与竞猜池元数据（标题、描述、初始赔率等）

---

## 🎬 Demo 演示


- 🎥 视频演示：https://x.com/mm130251/status/2016461877564592506

- 项目源码（运行说明见仓库 README）：  
  - https://github.com/mumuya1/chain-Betting

---

## 💡 核心功能

- **创建竞猜池**
  - 管理员在前端输入票价、总票数上限、截止时间、比赛标题及描述
  - 前端打包参数，通过 @solana/web3.js 调用合约初始化新池子

- **参与下注**
  - 用户通过 Phantom 钱包选择主胜 / 平局 / 客胜中的一方
  - 输入想购买的票数，前端计算应支付的 SOL 并发起交易
  - 合约校验截止时间与总票数上限，成功后更新链上记录

- **动态赔率展示**
  - 前端从链上读取三方总票数，根据初始赔率和实时投注比例计算展示赔率
  - 未有下注时使用初始赔率，有下注后根据实际比例动态调整，帮助用户决策

- **取消竞猜池**
  - 当池子尚无任何投注时，管理员可以在前端发起取消操作
  - 合约校验当前总票数为 0，更新状态为已取消，避免错误开放的池子长期占用资源

- **手动和自动结算**
  - 手动结算：管理员在比赛结束后指定获胜方，合约记录获胜方与结算时间
  - 自动结算：任意结算者可以调用自动结算指令，合约基于池地址与结束时间生成伪随机数决定获胜方

- **本地数据持久化与体验优化**
  - 使用 localStorage 记住最近使用的 RPC、Program ID 和 UI 表单默认值
  - 为每个池子缓存标题、描述和初始赔率，刷新页面后仍能显示人类可读的比赛信息，而不是纯地址哈希

---

## ✍️ 项目创作者：

- 创作者昵称：**mumuya1**
- 创作者联系方式：**1229318715@qq.com**
- 创作者 Solana USDC 钱包地址：GNhM94vzUaLrg94DWgGscxqTpuNpJseFpSKETZsZohNr
